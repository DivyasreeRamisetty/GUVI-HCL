package com.example.dependencyauditor.model;

import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;
import io.swagger.v3.oas.annotations.media.Schema;

@Document(collection = "vulnerabilities")
@Schema(description = "Security vulnerability information for dependencies")
public class Vulnerability {
    @Id
    @Schema(description = "Unique identifier of the vulnerability", accessMode = Schema.AccessMode.READ_ONLY)
    private String id;
    
    @Schema(description = "Name of the affected dependency", example = "log4j-core", required = true)
    private String dependencyName;
    
    @Schema(description = "Version of the dependency that is affected", example = "2.14.1", required = true)
    private String affectedVersion;
    
    @Schema(description = "Detailed description of the vulnerability", example = "Apache Log4j2 JNDI vulnerability CVE-2021-44228", required = true)
    private String description;
    
    @Schema(description = "Severity level of the vulnerability", example = "CRITICAL", allowableValues = {"LOW", "MEDIUM", "HIGH", "CRITICAL"}, required = true)
    private String severity;

    // Constructors
    public Vulnerability() {}

    public Vulnerability(String dependencyName, String affectedVersion, String description, String severity) {
        this.dependencyName = dependencyName;
        this.affectedVersion = affectedVersion;
        this.description = description;
        this.severity = severity;
    }

    // Getters and Setters
    public String getId() {
        return id;
    }

    public void setId(String id) {
        this.id = id;
    }

    public String getDependencyName() {
        return dependencyName;
    }

    public void setDependencyName(String dependencyName) {
        this.dependencyName = dependencyName;
    }

    public String getAffectedVersion() {
        return affectedVersion;
    }

    public void setAffectedVersion(String affectedVersion) {
        this.affectedVersion = affectedVersion;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public String getSeverity() {
        return severity;
    }

    public void setSeverity(String severity) {
        this.severity = severity;
    }
}
